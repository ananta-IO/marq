<template name="questionsAnswer">
	<div class="container" id="questions-answer">

		<div class="row-fluid">
			<div class="span12">
				<a href="#" class="next-unanswered-question pull-right">next unanswered &rarr;</a>
				<a href="#" class="previous-unanswered-question">&larr; previous unanswered</a>
			</div>
		</div>

		<div class="row-fluid">
			{{#if previousQuestion}}
				<div class="span1 hidden-phone">
					&nbsp;
				</div>
				<div class="span1 well hidden-phone flip previous-question">
					<p class="center"><i class="icon-chevron-left"></i></p>
				</div>
			{{else}}
				<div class="span2 well hidden-phone">
					<p>Fun Beautiful real-time bite-sized surveys</p>
					<p>Easily ask questions, get instant feedback, and discuss responses.</p>
					<p>Answer questions to see more or <a href="/questions/new">ask your own</a>.</p>
					<p><a href="/about">Learn more</a></p>
				</div>
			{{/if}}

			<div class="span8 well main-answer-view">
				{{#with question}}
					{{> question}}
				{{/with}}
			</div>


			{{#if nextQuestion}}
				<div class="span1 well hidden-phone flip next-question">
					<p class="center"><i class="icon-chevron-right"></i></p>
				</div>
				<div class="span1 hidden-phone">
					&nbsp;
				</div>
			{{else}}
				<div class="span2 well hidden-phone">
					<p><a href="/questions/new">Ask</a> and answer questions to see more.</p>
				</div>
			{{/if}}
		</div>

		<div class="row-fluid visible-phone">
			<div class="span12">
				<ul class="pager">
					<li class="previous {{#if previousQuestion}} {{else}}disabled{{/if}}">
						<a href="#" class="previous-question">&larr; previous</a>
					</li>
					<li class="next {{#if nextQuestion}} {{else}}disabled{{/if}}">
						<a href="#" class="next-question">next &rarr;</a>
					</li>
				</ul>
			</div>
		</div>

	</div>
</template>


<template name="question">
	<div id="question-{{_id}}" class="question">
		{{#if this}}

			<blockquote>
				<p class="lead">
					{{question}}
				<p/>
				{{#if imageUri}}
					<div class="row-fluid">
						<div class="span12" id="preview-image">
							<img src="{{imageUri}}" class="span12"></img>
						</div>
					</div>
				{{/if}}
			</blockquote>

			{{#if alert}}
				<div class="row-fluid">
					<div class="span12">
						{{#with alert}}
							<div class="alert alert-{{type}}">
								{{#if dismiss}}
									<button type="button" class="close" data-dismiss="alert">×</button>
								{{/if}}
								{{message}}
							</div>
						{{/with}}
					</div>
				</div>
			{{/if}}

			{{#if currentUserHasAnswered _id}}
				<div class="answer-choices">
					{{#each answerChoices}}
						<p>
							{{#if isUsersAnswer this}}
								<button class="btn btn-info btn-block btn-large answer selected" type="button" data-answer="{{this}}" disabled>
									<!-- <span class="marq"><span class="inner"></span></span> -->
									{{this}}
								</button>
							{{else}}
								<button class="btn btn-block btn-large answer" type="button" data-answer="{{this}}" disabled>
									<!-- <span class="marq"><span class="inner"></span></span> -->
									{{this}}
								</button>
							{{/if}}
						</p>
					{{/each}}
				</div>

				<hr/>
				<div class="row-fluid">
					<div class="span12">
						<div class="question-rate">
							<p class="lead">
								Was this a good question?
							</p>
							<p class="lead">
								{{#if voted _id}}
									you said <strong>{{vote _id}}</strong>
									&middot; cumulative rating <strong>{{voteTally}}</strong>
									<!-- <i class="icon-certificate"></i> -->
								{{else}}
									<span class="no-wrap">
										<button class="btn btn-success btn-large vote" type="button" data-vote="for">
											yes
										</button>
										&nbsp;
										<button class="btn btn-danger btn-large vote" type="button" data-vote="against">
											no
										</button>
									<span>
								{{/if}}
							</p>
						</div>
					</div>
				</div>
				<hr/>

				<div class="row-fluid">
					<div class="span12">
						<div class="chart"></div>
					</div>
				</div>

				<hr/>
				<div class="row-fluid">
					<div class="span12 well comments">
						<h5>Discussion <i class="icon-comment pull-right"></i></h5>
						<div class="row-fluid">
							<div class="span12 well past-comments">
								<div class="inner">
									{{#if anyComments}}
										{{#each comments}}
											<div class="row-fluid">
												<div id="comment-{{_id}}" class="comment span12">
													<blockquote class="{{#if isCurrentUsersComment ownerId}}pull-right{{/if}}">
														<p>{{comment}}</p>
														<small>{{ownerName}}</small>
													</blockquote>
												</div>
											</div>
										{{/each}}
									{{else}}
										<p class="prompt">Start the conversation for this question</p>
									{{/if}}
								</div>
							</div>
						</div>
						{{#if alert}}
							<div class="row-fluid">
								<div class="span12">
									{{#with alert}}
										<div class="alert alert-{{type}}">
											{{#if dismiss}}
												<button type="button" class="close" data-dismiss="alert">×</button>
											{{/if}}
											{{message}}
										</div>
									{{/with}}
								</div>
							</div>
						{{/if}}
						<div class="row-fluid">
							<div class="span12">
								<input type="text" class="new-comment span12 press-enter" placeholder="Write a comment..." maxlength="500" name="new-comment">
							</div>
						</div>
					</div>
				</div>
				<!-- <div class="row-fluid">
					<div class="span12">
						<button class="btn btn-primary post-comment" type="button">post</button>
					</div>
				</div> -->

			{{else}}
				<div class="answer-choices">
					{{#each answerChoices}}
						<p>
							<button class="btn btn-info btn-block btn-large answer" type="button" data-answer="{{this}}">
								<!-- <span class="marq"><span class="inner"></span></span> -->
								{{this}}
							</button>
						</p>
					{{/each}}
				</div>
			{{/if}}

		{{else}}
			{{> loading}}
		{{/if}}
	</div>
</template>