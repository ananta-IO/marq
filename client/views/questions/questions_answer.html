<template name="questionsAnswer">
	<div class="container" id="questions-answer">

		<div class="row-fluid visible-phone">
			<div class="span12">
				<a href="#" class="next-question pull-right btn btn-small">next <i class="icon-arrow-right"></i></a>
				<a href="#" class="previous-question btn btn-small"><i class="icon-arrow-left"></i> previous</a>
			</div>
		</div>

		<div class="row-fluid">

			{{#if previousQuestion}}
				<div class="span1 hidden-phone">
					&nbsp;
				</div>
				<div class="span1 well hidden-phone flip previous-question">
					<p class="center"><i class="icon-chevron-left"></i></p>
				</div>
			{{else}}
				<div class="span2 well hidden-phone">
					<p>Beautiful realtime surveys. Easily ask questions, get instant feedback, chat with respondents.</p>
					<p>Answer questions to view more or <a href="/questions/new">ask your own questions</a>.</p>
				</div>
			{{/if}}

			<div class="span8 well main-answer-view">
				{{#with question}}
					{{> question}}
				{{/with}}
			</div>


			{{#if nextQuestion}}
				<div class="span1 well hidden-phone flip next-question">
					<p class="center"><i class="icon-chevron-right"></i></p>
				</div>
				<div class="span1 hidden-phone">
					&nbsp;
				</div>
			{{else}}
				<div class="span2 well hidden-phone">
					<p><a href="#" class="previous-question">Answer</a> and <a href="/questions/new">ask</a> questions to view more.</p>
				</div>
			{{/if}}

		</div>

	</div>
</template>


<template name="question">
	<div id="question-{{_id}}" class="question">
		{{#if this}}

			{{#if alert}}
				<div class="row-fluid">
					<div class="span12">
						{{#with alert}}
							<div class="alert alert-{{type}}">
								{{#if dismiss}}
									<button type="button" class="close" data-dismiss="alert">×</button>
								{{/if}}
								{{message}}
							</div>
						{{/with}}
					</div>
				</div>
			{{/if}}

			<h3>
				{{question}}
			<h3/>

			{{#if currentUserHasAnswered _id}}
				<div class="answer-choices">
					{{#each answerChoices}}
						<p>
							{{#if isUsersAnswer this}}
								<button class="btn btn-info btn-block btn-large answer selected" type="button" data-answer="{{this}}" disabled>
									<!-- <span class="marq"><span class="inner"></span></span> -->
									{{this}}
								</button>
							{{else}}
								<button class="btn btn-block btn-large answer" type="button" data-answer="{{this}}" disabled>
									<!-- <span class="marq"><span class="inner"></span></span> -->
									{{this}}
								</button>
							{{/if}}
						</p>
					{{/each}}
				</div>

				<hr/>
				<div class="row-fluid">
					<div class="span12">
						<div class="question-rate">
							<p class="lead">
								Was this a good question?
								{{#if voted _id}}
									&middot; you said <strong>{{vote _id}}</strong>
									&middot; cumulative rating <strong>{{voteTally}}</strong>
									<!-- <i class="icon-certificate"></i> -->
								{{else}}
									<span class="no-wrap">
										<button class="btn btn-success vote" type="button" data-vote="for">
											yes
										</button>
										&nbsp;
										<button class="btn btn-danger vote" type="button" data-vote="against">
											no
										</button>
									<span>
								{{/if}}
							</p>
						</div>
					</div>
				</div>
				<hr/>

				<!-- <h5>Answer Breakdown</h5> -->
				<div class="row-fluid">
					<div class="span12">
						<div class="chart"></div>
					</div>
				</div>

				<hr/>
				<!-- <h5>Comments</h5> -->
				<div class="row-fluid">
					<div class="span12 well comments">
						<h5>Discussion <i class="icon-comment pull-right"></i></h5>
						<div class="row-fluid">
							<div class="span12 well past-comments">
								<div class="inner">
									{{#if anyComments}}
										{{#each comments}}
											<div id="comment-{{_id}}" class="comment">
												<p>{{comment}} <small class="pull-right">{{ownerName}} - {{createdAt}}</small></p>
											</div>
										{{/each}}
									{{else}}
										<p class="prompt">Start the conversation for this question</p>
									{{/if}}
								</div>
							</div>
						</div>
						{{#if alert}}
							<div class="row-fluid">
								<div class="span12">
									{{#with alert}}
										<div class="alert alert-{{type}}">
											{{#if dismiss}}
												<button type="button" class="close" data-dismiss="alert">×</button>
											{{/if}}
											{{message}}
										</div>
									{{/with}}
								</div>
							</div>
						{{/if}}
						<div class="row-fluid">
							<div class="span12">
								<input type="text" class="new-comment span12 press-enter" placeholder="chat" maxlength="500" name="new-comment">
							</div>
						</div>
					</div>
				</div>
				<!-- <div class="row-fluid">
					<div class="span12">
						<button class="btn btn-primary post-comment" type="button">post</button>
					</div>
				</div> -->

			{{else}}
				<div class="answer-choices">
					{{#each answerChoices}}
						<p>
							<button class="btn btn-info btn-block btn-large answer" type="button" data-answer="{{this}}">
								<!-- <span class="marq"><span class="inner"></span></span> -->
								{{this}}
							</button>
						</p>
					{{/each}}
				</div>
			{{/if}}

		{{else}}
			<p><a href="#" class="previous-question">Answer</a> and <a href="/questions/new">ask</a> questions to view more.</p>
		{{/if}}
	</div>
</template>